services:
    - docker
env:
    - secure: "ZRAcLUM7lpDVa+CU1mzDI1x7prqhOb8haB4W9t9W9IRMQNdR5bV+RM7m6oB8KLOEve66EOZviHrAHqVdLo8hwmREirA9wvEkZPakd93txVNchmti2P4ZL97S/OfYWlAycn9p7KIUFVZ7wxiKTAmY4FqsetAQDCMqXFGf0bn4HDKSrZSyYKUfSx5S+05NWh+wlzje+FERe/rqd9heiSpsR+le6OKDt+hNWvM1epIHoPTCt406+wbTNQbykbsO79QsCUyGpwYBXKz0vSSM3/HXyeYSfmsT9XVTDErlYgfE/eoVuZfWwUUfuWcH4ooHP7X5BCtOMsd42xQK+DdpyJEiwsvS6WVOWLGJtC0NrCws/nVTTDJoDnWmK6YxK6GMNOa8FS2kGnpDTCO53wh0rjvCOmZRvS47Zj+F1ETal1jGkhStNmA24F7ZwUlrRCQ2yR5p/1sc/pj+CT9QHIRO6Y4GGo3EP5A3wwxdPUQbD6m+3wjUr6VjFPgP4lJoVMZ036tsbUjH3ntuChDOYoifKPPbrDS4Wtpxk6FwJqAwJ4VA+1/THq9HOhrA2mDhFhohaS2ploGDsI9NKWnJC2+NQnjDGoa/KZIvAZNg5mPwRPxPFAOjkMY7EM4MbNZI4JtfQQSCtr2E8Vc+mPyue73NFjNwRIUFt5F6Yr2yPQPDHAOqXho="
install:
    - docker build --target test --tag todo-app:test .

script:
    - docker run --mount type=bind,source="$(pwd)",target=/app todo-app:test tests/unit
    - docker run --mount type=bind,source="$(pwd)",target=/app todo-app:test tests/integration
    - docker run -e TRELLO_API_KEY -e TRELLO_API_SECRET --mount type=bind,source="$(pwd)",target=/app todo-app:test tests/end_to_end
    